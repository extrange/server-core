tcp:
  services:
    chanel-server:
      loadBalancer:
        servers:
          - address: 192.168.1.135:443
  routers:
    chanel-server:
      rule: HostSNIRegexp(`^.+\.chanelng\.com$`) || HostSNI(`chanelng.com`)
      service: chanel-server
      tls:
        passthrough: true

http:
  middlewares:
    check-superuser:
      forwardAuth:
        address: http://backend:8000/account/check-superuser/
    no-index:
      headers:
        customResponseHeaders:
          X-Robots-Tag: none
    security-headers:
      headers:
        # securityheaders.com
        stsSeconds: 31536000
        stsIncludeSubdomains: true
        frameDeny: true
        contentTypeNosniff: true
        referrerPolicy: no-referrer
        customResponseHeaders: # Removes response headers
          x-powered-by: ""
          server: ""

  routers:
    dashboard:
      rule: Host(`traefik.internal.nicholaslyz.com`)
      entrypoints:
        - tailscale
      service: api@internal

  # Only available via the file provider
  # https://github.com/traefik/traefik/issues/7893
  serversTransports:
    unifi:
      # Unifi controller uses a self-signed cert
      insecureSkipVerify: true
