services:
  browserless:
    container_name: browserless
    image: ghcr.io/browserless/chromium@sha256:e3711f0d4a651449dedfebc976df5711c25da8fb0bef8e11219addb6bf68c1c1
    restart: always
    environment:
      TZ: Asia/Singapore
      TOKEN: ${BROWSERLESS_TOKEN}
      DEFAULT_STEALTH: true
      PROXY_HOST: browserless.nicholaslyz.com
      PROXY_PORT: 443
      PROXY_SSL: true

      # The following are necessary for link previews to work
      DEFAULT_BLOCK_ADS: true
      ENABLE_CORS: true
      DEFAULT_IGNORE_HTTPS_ERRORS: true
    networks:
      - browserless # Allow use by other containers outside of server-core
      - default
    labels:
      traefik.docker.network: server-core_default
      traefik.enable: true
      traefik.http.routers.browserless.rule: Host(`browserless.nicholaslyz.com`)
      traefik.http.services.browserless.loadbalancer.server.port: 3000
